<div class="bg-black text-white p-8">
  <div class="max-w-5xl mx-auto">
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-4xl font-bold mb-2 text-yellow-500">User & Admin Management</h1>
      <p class="text-red-400">Manage gallery access and admin privileges</p>
    </div>

    <!-- Invite New User -->
    <div class="bg-gray-900 border border-red-600 rounded-lg p-6 mb-8">
      <div class="flex justify-between items-center">
        <div>
          <h2 class="text-xl font-bold text-yellow-500">Send Invitation</h2>
          <p class="text-gray-400 mt-1">Invite someone to view the gallery (with optional admin privileges)</p>
        </div>
        <%= link_to "Send New Invitation", new_admin_invite_path,
            class: "px-6 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition" %>
      </div>
    </div>

    <!-- Sitter Invitations -->
    <div class="bg-gray-900 border border-purple-600 rounded-lg p-6 mb-8">
      <div class="flex justify-between items-center">
        <div>
          <h2 class="text-xl font-bold text-purple-400">üì∏ Sitter Invitations</h2>
          <p class="text-gray-400 mt-1">Manage invitations for all portrait sitters from the database</p>
        </div>
        <%= link_to "Manage Sitter Invites", sitters_admin_invites_path,
            class: "px-6 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition" %>
      </div>
    </div>

    <!-- Stats Summary -->
    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
      <div class="bg-gray-900 border border-gray-700 rounded-lg p-4 text-center">
        <div class="text-2xl font-bold text-yellow-500"><%= @admins.count %></div>
        <div class="text-sm text-gray-400">Active Admins</div>
      </div>
      <div class="bg-gray-900 border border-gray-700 rounded-lg p-4 text-center">
        <div class="text-2xl font-bold text-green-400"><%= @accepted_users.count %></div>
        <div class="text-sm text-gray-400">Gallery Users</div>
      </div>
      <div class="bg-gray-900 border border-gray-700 rounded-lg p-4 text-center">
        <div class="text-2xl font-bold text-orange-400">
          <%= @pending_admin_invites.count + @pending_user_invites.count %>
        </div>
        <div class="text-sm text-gray-400">Pending Invites</div>
      </div>
      <div class="bg-gray-900 border border-gray-700 rounded-lg p-4 text-center">
        <div class="text-2xl font-bold text-blue-400">
          <%= @admins.count + @accepted_users.count + @pending_admin_invites.count + @pending_user_invites.count %>
        </div>
        <div class="text-sm text-gray-400">Total Invited</div>
      </div>
    </div>

    <!-- Current Admins -->
    <div class="bg-gray-900 border border-red-600 rounded-lg p-6 mb-8">
      <h2 class="text-xl font-bold text-yellow-500 mb-4">üëë Current Admins</h2>

      <% if @admins.any? %>
        <div class="space-y-3">
          <% @admins.each do |admin| %>
            <div class="flex justify-between items-center py-3 border-b border-gray-700">
              <div>
                <div class="font-semibold text-white">
                  <%= admin.email %>
                  <% if admin.superadmin? %>
                    <span class="ml-2 px-2 py-1 bg-yellow-600 text-black text-xs rounded">SUPERADMIN</span>
                  <% else %>
                    <span class="ml-2 px-2 py-1 bg-red-600 text-white text-xs rounded">ADMIN</span>
                  <% end %>
                </div>
                <div class="text-sm text-gray-400">
                  <% if admin.name.present? %>
                    <%= admin.name %> ‚Ä¢
                  <% end %>
                  Joined <%= admin.created_at.strftime("%B %d, %Y") %>
                </div>
              </div>

              <% unless admin.superadmin? || admin == current_user %>
                <%= button_to "Revoke Admin",
                    admin_invite_path(admin),
                    method: :delete,
                    data: { confirm: "Are you sure you want to revoke admin privileges for #{admin.email}?" },
                    class: "px-4 py-1 bg-gray-700 text-red-400 rounded hover:bg-gray-600 transition text-sm" %>
              <% end %>
            </div>
          <% end %>
        </div>
      <% else %>
        <p class="text-gray-400">No admins yet</p>
      <% end %>
    </div>

    <!-- Gallery Users (Non-Admins) -->
    <% if @accepted_users.any? %>
      <div class="bg-gray-900 border border-green-600 rounded-lg p-6 mb-8">
        <h2 class="text-xl font-bold text-green-400 mb-4">üë§ Gallery Users (Non-Admin)</h2>

        <div class="space-y-3">
          <% @accepted_users.each do |user| %>
            <div class="flex justify-between items-center py-3 border-b border-gray-700">
              <div>
                <div class="font-semibold text-white">
                  <%= user.email %>
                  <span class="ml-2 px-2 py-1 bg-green-600 text-white text-xs rounded">USER</span>
                </div>
                <div class="text-sm text-gray-400">
                  <% if user.name.present? %>
                    <%= user.name %> ‚Ä¢
                  <% end %>
                  Joined <%= user.created_at.strftime("%B %d, %Y") %>
                </div>
              </div>

              <div class="flex gap-2">
                <%= button_to "Make Admin",
                    admin_invite_path(user),
                    method: :patch,
                    params: { make_admin: true },
                    class: "px-4 py-1 bg-yellow-600 text-black rounded hover:bg-yellow-500 transition text-sm" %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Pending Invitations -->
    <% if @pending_admin_invites.any? || @pending_user_invites.any? %>
      <div class="bg-gray-900 border border-orange-600 rounded-lg p-6 mb-8">
        <h2 class="text-xl font-bold text-orange-400 mb-4">‚è≥ Pending Invitations</h2>

        <div class="space-y-3">
          <!-- Pending Admin Invites -->
          <% @pending_admin_invites.each do |invite| %>
            <div class="flex justify-between items-center py-3 border-b border-gray-700">
              <div>
                <div class="font-semibold text-white">
                  <%= invite.email %>
                  <span class="ml-2 px-2 py-1 bg-red-600 text-white text-xs rounded">ADMIN INVITE</span>
                </div>
                <div class="text-sm text-gray-400">
                  <% if invite.name.present? %>
                    <%= invite.name %> ‚Ä¢
                  <% end %>
                  Invited <%= time_ago_in_words(invite.invitation_sent_at) %> ago
                  <% if invite.invitation_created_at && invite.invitation_sent_at %>
                    ‚Ä¢ Expires in <%= distance_of_time_in_words(Time.current, invite.invitation_created_at + 30.days) %>
                  <% end %>
                </div>
              </div>

              <%= button_to "Resend",
                  resend_admin_invite_path(invite),
                  method: :post,
                  class: "px-4 py-1 bg-yellow-600 text-black rounded hover:bg-yellow-500 transition text-sm" %>
            </div>
          <% end %>

          <!-- Pending User Invites -->
          <% @pending_user_invites.each do |invite| %>
            <div class="flex justify-between items-center py-3 border-b border-gray-700">
              <div>
                <div class="font-semibold text-white">
                  <%= invite.email %>
                  <span class="ml-2 px-2 py-1 bg-green-600 text-white text-xs rounded">USER INVITE</span>
                </div>
                <div class="text-sm text-gray-400">
                  <% if invite.name.present? %>
                    <%= invite.name %> ‚Ä¢
                  <% end %>
                  Invited <%= time_ago_in_words(invite.invitation_sent_at) %> ago
                  <% if invite.invitation_created_at && invite.invitation_sent_at %>
                    ‚Ä¢ Expires in <%= distance_of_time_in_words(Time.current, invite.invitation_created_at + 30.days) %>
                  <% end %>
                </div>
              </div>

              <%= button_to "Resend",
                  resend_admin_invite_path(invite),
                  method: :post,
                  class: "px-4 py-1 bg-yellow-600 text-black rounded hover:bg-yellow-500 transition text-sm" %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>

    <!-- Summary Info -->
    <div class="bg-gray-900 border border-gray-700 rounded-lg p-6 mb-8">
      <h3 class="text-lg font-semibold text-yellow-500 mb-3">üìä Access Summary</h3>
      <div class="grid md:grid-cols-2 gap-4 text-sm">
        <div>
          <p class="text-gray-400">
            <span class="text-white font-semibold">Admins can:</span><br>
            ‚Ä¢ Select hero photos<br>
            ‚Ä¢ Apply tags for filtering<br>
            ‚Ä¢ Access admin dashboard<br>
            ‚Ä¢ Send invitations
          </p>
        </div>
        <div>
          <p class="text-gray-400">
            <span class="text-white font-semibold">Regular users can:</span><br>
            ‚Ä¢ View all gallery photos<br>
            ‚Ä¢ Browse hero selections<br>
            ‚Ä¢ Download photos<br>
            ‚Ä¢ View session details
          </p>
        </div>
      </div>
    </div>

    <!-- Back Link -->
    <div class="mt-8">
      <%= link_to "‚Üê Back to Admin Dashboard", admin_dashboard_path,
          class: "text-yellow-500 hover:text-yellow-400 transition" %>
    </div>
  </div>
</div>